<%= content_tag_for :li, comment do %>
  <% present comment do |comment_presenter| %>
    <h5 class="comment_details">
      <span class="comment_toggler">[-]</span>
      <%= comment_presenter.linked_username %>
      <%= comment_presenter.time_since_created %>
      <%= comment_presenter.time_since_edited %>
      <span class="comments_count">(<%= comment_presenter.comments_count %>)</span>
    </h5>

    <div class="comment_main">
      <p class="comment_text">
        <%= comment_presenter.text %>
      </p>

      <footer class="comment_links">
        <%= comment_presenter.reply_link %>
        <%= comment_presenter.parent_link %>

        <% if policy(comment).update? %>
          <%= comment_presenter.edit_link %>
        <% end %>

        <% if policy(comment).destroy? %>
          <%= comment_presenter.delete_link %>
        <% end %>
      </footer>

      <p class="comment_form"></p>

      <% if comment.has_comments? %>
        <ul class="comments nested">
          <%= render comment.top_level_comments %>
        </ul>
      <% end %>
    </div>
  <% end %>
<% end %>
